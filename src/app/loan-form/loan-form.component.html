<div class="logo-wrapper">
  <svg class="logo" viewBox="0 0 600 120" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
    <defs>
      <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="0%">
        <stop offset="0%" stop-color="#00e5ff" />
        <stop offset="50%" stop-color="#00c6ff" />
        <stop offset="100%" stop-color="#0080ff" />
      </linearGradient>
    </defs>
    <g transform="translate(300, 60)">
      <text text-anchor="middle" alignment-baseline="middle" class="loan-text">LoanLen$</text>
    </g>
  </svg>
</div>

<div class="form-wrapper">
  <h1>Loan Eligibility Checker</h1>
  
  <form [formGroup]="form" (ngSubmit)="submit()">
    
    <!-- Loan Amount -->
    <div class="form-group">
      <div class="input-wrapper">
        <input
          type="text"
          placeholder="Loan Amount (LKR)"
          formControlName="loanAmount"
          #loanAmountInput
          (keydown.enter)="onFieldExit('loanAmount'); $event.preventDefault(); focusNext(interestRateInput)"
          (keypress)="allowDecimalInput($event, true)"
          (paste)="blockInvalidPaste($event)"
        />
        <span
          class="invalid-icon-outline"
          *ngIf="isInvalid('loanAmount')"
          [attr.aria-label]="getErrorMessage('loanAmount')"
        ></span>
      </div>
    </div>

    <!-- Interest Rate -->
    <div class="form-group">
      <div class="input-wrapper">
        <input
          type="text"
          placeholder="Interest Rate (%)"
          formControlName="interestRate"
          #interestRateInput
          (keydown.enter)="onFieldExit('interestRate'); $event.preventDefault(); focusNext(tenureInput)"
          (keydown)="allowDecimalInput($event, true, 'interestRate')"
          (paste)="blockInvalidPaste($event)"
        />
        <span
          class="invalid-icon-outline"
          *ngIf="isInvalid('interestRate')"
          [attr.aria-label]="getErrorMessage('interestRate')"
        ></span>
      </div>
    </div>

    <!-- Tenure Duration -->
    <div class="form-group">
      <div class="input-wrapper">
        <input
          type="text"
          placeholder="Tenure Duration (Months)"
          formControlName="tenureMonths"
          #tenureInput
          (keydown.enter)="onFieldExit('tenureMonths'); $event.preventDefault(); focusNext(monthlyIncomeInput)"
          (keypress)="allowDecimalInput($event, false)"
          (paste)="blockInvalidPaste($event)"
        />
        <span
          class="invalid-icon-outline"
          *ngIf="isInvalid('tenureMonths')"
          [attr.aria-label]="getErrorMessage('tenureMonths')"
        ></span>
      </div>
    </div>

    <!-- Monthly Income -->
    <div class="form-group">
      <div class="input-wrapper">
        <input
          type="text"
          placeholder="Monthly Income (LKR)"
          formControlName="monthlyIncome"
          #monthlyIncomeInput
          (keydown.enter)="onFieldExit('monthlyIncome'); $event.preventDefault(); handleLastFieldEnter(submitBtn)"
          (keypress)="allowDecimalInput($event, true)"
          (paste)="blockInvalidPaste($event)"
        />
        <span
          class="invalid-icon-outline"
          *ngIf="isInvalid('monthlyIncome')"
          [attr.aria-label]="getErrorMessage('monthlyIncome')"
        ></span>
      </div>
    </div>

    <!-- Submit Button -->
    <button
      type="submit"
      [disabled]="form.invalid"
      #submitBtn
      (keydown.enter)="focusFirstInvalid()"
    >
      Check Eligibility
    </button>
  </form>

  <!-- Result -->
 <!-- Result -->
<div class="result-box" *ngIf="result">
  <h2 [ngClass]="result.isEligible ? 'result-title status-eligible' : 'result-title status-not-eligible'">
    <span class="status-icon">
      {{ result.isEligible ? 'âœ…' : 'âŒ' }}
    </span>
    <span class="status-text">
      {{ result.isEligible ? 'Loan Eligible' : 'Loan Not Eligible' }}
    </span>
  </h2>
  

  <div class="result-metrics">
    <div class="metric">
      <label>ğŸ’° Estimated EMI:</label>
      <div class="value">Rs. {{ result.emi | number: '1.2-2' }}</div>
    </div>

    <div class="metric">
      <label>ğŸ“Š EMI to Income Ratio:</label>
      <div class="value">{{ result.emiRatio }}%</div>
    </div>

    <div class="metric">
      <label>ğŸ›¡ï¸ Risk Classification:</label>
      <div class="value risk">{{ result.riskCategory || 'N/A' }}</div>
    </div>
  </div>

  <p class="note">
    ğŸ“Œ <strong>Disclaimer:</strong> This is a preliminary eligibility assessment based on the provided data.
    This result does not constitute a loan offer.
  </p>
</div>
</div>

<div class="floating-error" *ngIf="errorMessage">
  {{ errorMessage }}
</div>
